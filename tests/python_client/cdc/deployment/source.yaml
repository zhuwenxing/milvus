# This is a sample to deploy a milvus cluster using pulsar with minimum cost of resources.
apiVersion: milvus.io/v1beta1
kind: Milvus
metadata:
  name: cdc-test-source-0918
  namespace: chaos-testing
  labels:
    app: milvus
spec:
  mode: standalone
  config:
    common:
      security:
        authorizationEnabled: true
    log:
      level: debug
  components:
    image: harbor.milvus.io/milvus/milvus:chyezh-enhance_DDL_CDC_final-a736172-20250918
    disableMetric: false
    standalone:
      resources:
        requests:
          cpu: 2
          memory: 8Gi
        limits:
          cpu: 2
          memory: 8Gi
      replicas: 1
  dependencies:
    msgStreamType: pulsar
    etcd:
      inCluster:
        deletionPolicy: Retain
        pvcDeletion: false
        values:
          replicaCount: 3
          metrics:
            enabled: true
            podMonitor:
              enabled: true
              namespace: chaos-testing
    pulsar:
      inCluster:
        deletionPolicy: Retain
        pvcDeletion: false
        values:
          components:
            autorecovery: false
            functions: false
            toolset: false
            pulsar_manager: false
          monitoring:
            prometheus: false
            grafana: false
            node_exporter: false
            alert_manager: false
          proxy:
            replicaCount: 1
            resources:
              requests:
                cpu: 0.01
                memory: 256Mi
            configData:
              PULSAR_MEM: >
                -Xms256m -Xmx256m
              PULSAR_GC: >
                -XX:MaxDirectMemorySize=256m